{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "CAWS Provenance Manifest",
  "type": "object",
  "required": ["agent", "model", "model_hash", "tool_allowlist", "commit", "artifacts", "results", "approvals", "sbom", "attestation"],
  "properties": {
    "agent": {
      "type": "string",
      "description": "Agent identifier"
    },
    "model": {
      "type": "string",
      "description": "Model identifier"
    },
    "model_hash": {
      "type": "string",
      "description": "Model hash for reproducibility"
    },
    "tool_allowlist": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Allowed tools for the agent"
    },
    "prompts": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Prompts used by the agent"
    },
    "commit": {
      "type": "string",
      "description": "Git commit hash"
    },
    "artifacts": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Generated artifacts"
    },
    "results": {
      "type": "object",
      "properties": {
        "coverage_branch": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Branch coverage percentage"
        },
        "mutation_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Mutation test score"
        },
        "tests_passed": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of tests passed"
        },
        "contracts": {
          "type": "object",
          "properties": {
            "consumer": {
              "type": "boolean",
              "description": "Consumer contract tests passed"
            },
            "provider": {
              "type": "boolean",
              "description": "Provider contract tests passed"
            }
          }
        },
        "a11y": {
          "type": "string",
          "enum": ["pass", "fail", "partial"],
          "description": "Accessibility test results"
        },
        "perf": {
          "type": "object",
          "description": "Performance test results"
        }
      },
      "additionalProperties": true
    },
    "approvals": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Human approvals"
    },
    "sbom": {
      "type": "string",
      "description": "SBOM attestation"
    },
    "attestation": {
      "type": "string",
      "description": "SLSA attestation"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Creation timestamp"
    },
    "version": {
      "type": "string",
      "description": "Manifest version"
    },
    "hash": {
      "type": "string",
      "description": "Manifest hash"
    }
  }
}
